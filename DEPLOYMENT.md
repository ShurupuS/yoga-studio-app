# üöÄ GitHub Actions Deployment Guide

–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è —Å –ø–æ–º–æ—â—å—é GitHub Actions.

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ù–∞ VPS:
- Ubuntu/Debian —Å–µ—Ä–≤–µ—Ä
- Docker –∏ Docker Compose
- SSH –¥–æ—Å—Ç—É–ø
- –ú–∏–Ω–∏–º—É–º 1GB RAM, 2GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞

### –ù–∞ GitHub:
- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å –∫–æ–¥–æ–º
- –î–æ—Å—Ç—É–ø –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

## üîß –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ VPS

### 1.1 –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
```bash
ssh root@your-server-ip
```

### 1.2 –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```bash
# –°–∫–∞—á–∞–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç
curl -O https://raw.githubusercontent.com/ShurupuS/yoga-studio-app/main/setup-vps.sh
chmod +x setup-vps.sh
./setup-vps.sh
```

### 1.3 –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
nano /opt/yoga-studio/.env
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ .env:**
```bash
POSTGRES_PASSWORD=your_very_secure_password_123
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production-123456789
```

## üîë –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –∫–ª—é—á–µ–π

### 2.1 –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ SSH –∫–ª—é—á –¥–ª—è GitHub Actions
```bash
# –ù–∞ VPS
ssh-keygen -t rsa -b 4096 -C "github-actions" -f /home/github-actions/.ssh/id_rsa

# –î–æ–±–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –≤ authorized_keys
cat /home/github-actions/.ssh/id_rsa.pub >> /home/github-actions/.ssh/authorized_keys
chmod 600 /home/github-actions/.ssh/authorized_keys
chown -R github-actions:github-actions /home/github-actions/.ssh
```

### 2.2 –ü–æ–ª—É—á–∏—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á
```bash
# –ù–∞ VPS - —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç –∫–ª—é—á
cat /home/github-actions/.ssh/id_rsa
```

## üîê –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è: `Settings` ‚Üí `Secrets and variables` ‚Üí `Actions`

### –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ–∫—Ä–µ—Ç—ã:

| Secret Name | Value | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------------|-------|----------|
| `VPS_HOST` | `your-server-ip` | IP –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ VPS |
| `VPS_USERNAME` | `github-actions` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è SSH |
| `VPS_SSH_KEY` | `-----BEGIN OPENSSH PRIVATE KEY-----...` | –ü—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á |
| `VPS_PORT` | `22` | SSH –ø–æ—Ä—Ç (–æ–±—ã—á–Ω–æ 22) |

## üöÄ –®–∞–≥ 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–ø–ª–æ—è

### 4.1 –°–¥–µ–ª–∞–π—Ç–µ –∫–æ–º–º–∏—Ç –∏ –ø—É—à
```bash
git add .
git commit -m "Add GitHub Actions deployment"
git push origin main
```

### 4.2 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –¥–µ–ø–ª–æ—è
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `Actions` –≤–∫–ª–∞–¥–∫—É –Ω–∞ GitHub
2. –ù–∞–π–¥–∏—Ç–µ workflow "Deploy to VPS"
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### 4.3 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
# –ù–∞ VPS
curl http://localhost:18080/actuator/health

# –°–Ω–∞—Ä—É–∂–∏
curl http://your-server-ip:18080/actuator/health
```

## üìä –®–∞–≥ 5: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

### 5.1 –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
# –ù–∞ VPS
docker-compose logs -f app
```

### 5.2 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è
```bash
# –ù–∞ VPS - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
tail -f /opt/yoga-studio/logs/health.log
```

### 5.3 –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
# –ù–∞ VPS
docker-compose ps
```

## üîÑ Workflow —Ñ–∞–π–ª—ã

### `deploy.yml` - –û—Å–Ω–æ–≤–Ω–æ–π –¥–µ–ø–ª–æ–π
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –ø—É—à–µ –≤ `main`
- –°–æ–±–∏—Ä–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –î–µ–ø–ª–æ–∏—Ç –Ω–∞ VPS
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ

### `test.yml` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ PR –∏ –ø—É—à–µ
- –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ—Å—Ç—ã
- –°–æ–±–∏—Ä–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### `backup.yml` - –ë—ç–∫–∞–ø—ã
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –±—ç–∫–∞–ø—ã –ë–î –≤ 2:00 AM
- –•—Ä–∞–Ω–∏—Ç 7 –¥–Ω–µ–π –ª–æ–∫–∞–ª—å–Ω–æ
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤ GitHub Artifacts

## üõ†Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ–ø–ª–æ–µ–º

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –¥–µ–ø–ª–æ—è
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `Actions` ‚Üí `Deploy to VPS`
2. –ù–∞–∂–º–∏—Ç–µ `Run workflow`
3. –í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ç–∫—É –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ

### –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
```bash
# –ù–∞ VPS
cd /opt/yoga-studio
git log --oneline  # –ù–∞–π–¥–∏—Ç–µ –Ω—É–∂–Ω—ã–π –∫–æ–º–º–∏—Ç
git checkout <commit-hash>
docker-compose up -d --build
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
# –ù–∞ VPS
docker-compose down
```

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –î–µ–ø–ª–æ–π –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ GitHub Secrets
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs app`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞–º—è—Ç—å: `docker stats`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç—ã: `netstat -tulpn`

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞
- –£–≤–µ–ª–∏—á—å—Ç–µ –ø–∞–º—è—Ç—å VPS
- –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ JVM –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

## üìà –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–∞–¥–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–∞
2. **–ë—ç–∫–∞–ø—ã**: –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –±—ç–∫–∞–ø—ã –ë–î
3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è**: –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –ø–∞—Ä–æ–ª–∏ –∏ –∫–ª—é—á–∏

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É –≤–∞—Å –±—É–¥–µ—Ç:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø—É—à–µ –≤ main
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –±—ç–∫–∞–ø—ã –ë–î
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π –æ—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –≤–µ—Ä—Å–∏—è–º

–í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: `http://your-server-ip:18080`
